function initialize(){var a={center:new google.maps.LatLng(35.7780787,139.7972246),zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP};$("#map").height($(".row").height()-$(".spot-description").height());var b=new google.maps.Map(document.getElementById("map"),a),c={};$.ajax("data/spots.csv").done(function(a){var d=Papa.parse(a,{header:!0});for(var e in d.data){var f=d.data[e];if(""!=f.category){var g=new google.maps.LatLng(parseFloat(f.lat),parseFloat(f.lng)),h=new google.maps.Marker({position:g,map:b,title:f.name,visible:1==f.category});c[f.category]?c[f.category].push(h):c[f.category]=[h],google.maps.event.addListener(h,"click",function(a){return function(){var c=this;b.setCenter(c.getPosition()),$a=$("<a />").attr("href",a.link).attr("target","_blank").text(a.name),$(".spot-description").empty().append($a),$(".spot-description").show(),$("#map").height($(".row").height()-$(".spot-description").height())}}(f))}}}),$.ajax("data/category.csv").done(function(a){$categorySelector=$(".categorySelector select");var b=Papa.parse(a,{header:!0});for(var d in b.data){var e=b.data[d];""!=e.id&&($option=$("<option />").val(e.id).text(e.name),$categorySelector.append($option))}$categorySelector.change(function(){$selectedCategory=$(this).val();for(var a in c){var b=!1;a==$selectedCategory&&(b=!0),$.each(c[a],function(){this.setVisible(b)})}})})}google.maps.event.addDomListener(window,"load",initialize);